[toc]

## Вариант курсовой работы

МКЭ для **гиперболического** уравнения в полярной $(r, \varphi)$ системе координат, **трехслойная явная схема** для аппроксимаций по времени, базисные функции **билинейные на прямоугольниках**.

## Решаемое уравнение

Решаемое уравнение в общем виде: 

$$
-{\rm div}(\lambda {\rm grad}(u)) + \gamma u + \sigma \frac{\partial u}{\partial t} + \chi \frac{\partial^{2}u}{\partial t^{2}} = f
$$

Область интегрирования: $\Omega$

Граница интегрирования: $S = S_1 \lor S_2 \lor S_3$

Начальные условия:

$$
\begin{gather*}
   \left. u \right|_{t=t_{0}} = u_{0},  \\
   \left. \frac{\partial u}{\partial t} \right|_{t=t_{0}} = u^{'}_{0}, 
\end{gather*}
$$

и тогда следующий слой $u_{1}$ будет считаться по следующей формуле:

$$
u_{1} \approx u_{0} + \left. \frac{\partial u}{\partial t} \right|_{t=t_{0}} \cdot (t-t_{0}),
$$

либо можем задать следующий слой сразу:

$$
\begin{gather*}
   \left. u \right|_{t=t_{0}} = u_{0}, \\
   \left. u \right|_{t=t_{1}} = u_{1}.
\end{gather*}
$$

Краевые условия:

$$
\begin{gather*}
   u|_{s_1} = u_{g} \\
   \lambda \frac{\partial u}{\partial n} = \theta \\
   \lambda \frac{\partial u}{\partial n} |_{s_3} + \beta(u|_{s_3} - u_{\beta}) = 0
\end{gather*}
$$

$\lambda$ - коэффициент диффузии,

$\beta$ - коэффициент теплообмена.

Согласно условиям варианта, в задаче используется полярная система координат $(r, \varphi)$. Для неё формулы операторов уравнения определяются следующим видом:

$$
{\rm grad}\space v = (\frac{\partial v}{\partial r}, \frac{1}{r} \frac{\partial v}{\partial \varphi})
$$

$$
{\rm div}\space \overrightarrow{Q} = \frac{1}{r} \frac{\partial (rQ_1)}{\partial r} + \frac{1}{r} \frac{\partial Q_2}{\partial \varphi}
$$

А само уравнение в таком случае будет выглядеть следующим образом:

$$
-\frac{1}{r}\frac{\partial}{\partial r}\left(r\lambda \frac{\partial u}{\partial r}\right) - \frac{1}{r^{2}}\frac{\partial}{\partial \varphi}\left(\lambda \frac{\partial u}{\partial \varphi}\right) + \gamma u + \sigma \frac{\partial u}{\partial t} + \chi \frac{\partial^{2}u}{\partial t^{2}} = f
$$

В учебнике конечномерная аппроксимация строится для случая, когда $\gamma = 0$, и формула выглядит так:

$$ 
-{\rm div}(\lambda {\rm grad}(u)) + \sigma \frac{\partial u}{\partial t} + \chi \frac{\partial^{2}u}{\partial t^{2}} = f
$$

И такая формула с учётом системы координат примет следующий вид:

$$
-\frac{1}{r}\frac{\partial}{\partial r}\left(r\lambda \frac{\partial u}{\partial r}\right) - \frac{1}{r^{2}}\frac{\partial}{\partial \varphi}\left(\lambda \frac{\partial u}{\partial \varphi}\right) + \sigma \frac{\partial u}{\partial t} + \chi \frac{\partial^{2}u}{\partial t^{2}} = f
$$


## Явная и неявная схемы

Нам необходимо выполнять аппроксимацию по времени. Поэтому в уравнении $(7.2)$ производные по времени заменяются их конечно-разностными аналогами. Например, эллиптическое уравнение можно записать следующими способами:

$$
\begin{gather}
   \sigma \frac{u_{j} - u_{j-1}}{\Delta t} - {  div}(\lambda \ {  grad}(u_{j})) = f_{j}\tag{7.7} \\
   \sigma \frac{u_{j} - u_{j-1}}{\Delta t} - {  div}(\lambda \ {  grad}(u_{j-1})) = f_{j-1}\tag{7.8}
\end{gather}
$$

Уравнение $(7.7)$ является **неявной схемой**, а уравнение $(7.8)$ - **явной**.

## Построение явной схемы гиперболического уравнения

### Явная схема с равномерным шагом

*Гиперболическое уравнение в явной схеме с равномерным шагом*  можно записать следующим образом:

$$
\chi \frac{u_{j} - 2u_{j-1} + u_{j-2}}{\Delta t^{2}} + \sigma \frac{u_{j} - u_{j-2}}{2\Delta t} - {  div} (\lambda {  grad}(u_{j-1})) = f_{j-1} \tag{7.38}
$$

Из прошлого курсача, решением эллиптического уравнения является вектор $q$ системы $Aq = b$, где $A = M+G + M_{S_{3}}$, $b = f + b_{S_{2}} + b_{S_{3}}$. Представим эту систему в виде $Mq + Gq + M_{S_{3}}q = b$. Тогда, если выполнить конечномерную аппроксимацию уравнения $(7.38)$, подставляя в матрицу $M$ вместо коэф. $\gamma$ коэффициенты $\sigma$ и $\chi$, получим следующее уравнение:

$$
\begin{split}
   \frac{1}{{\Delta t^{2}}} M^{\chi} q^{j} - \frac{2}{{\Delta t^{2}}} M^{\chi} q^{j-1} + \frac{1}{{\Delta t^{2}}} M^{\chi} q^{j-2} \\
   +\frac{1}{{2 \Delta t}} M^{\sigma} q^{j} - \frac{1}{{2\Delta t}} M^{\sigma} q^{j-2} + G q^{j-1} = b^{j-1} \tag{7.40}
\end{split}
$$

Данное уравнение можно записать в виде системы $Aq^{j} = d$ с матрицей

$$
A = \frac{1}{{\Delta t^{2}}} M^{\chi} + \frac{1}{{2\Delta t}} M^\sigma
$$

и вектором правой части

$$
d = b^{j-1} + \frac{2}{{\Delta t^{2}}} M^{\chi} q^{j-1} - \frac{1}{{\Delta t^{2}}} M^{\chi} q^{j-2} + \frac{1}{{2\Delta t}} M^{\sigma}q^{j-2} - Gq^{j-1}.
$$

Здесь стоит указать один момент: так как параметры $\chi$, $\sigma$, $\lambda$ не зависят от $t$, то и матрицы $M^{\chi}$, $M^{\sigma}$, $G$ не будут зависеть от $t$, а следовательно не будут меняться в зависимости от временного слоя. Поэтому эффективнее всего *вычислить их заранее* до того, как начать вычислять временную аппроксимацию.

### Явная схема с неравномерным шагом

Для аппроксимации искомого решения на сетке с неравномерным временным шагом удобнее всего разложить решение по слоям с помощью базисных квадратичных функций по времени $\eta_{i}^{j}$:

$$
u(x,y,t) \approx u^{j-2}(x,y) \ \eta^{j}_{2}(t) + u^{j-1}(x,y)\ \eta^{j}_{1}(t) + u^{j}(x,y)\ \eta^{j}_{0}(t), \tag{7.14}
$$

где функции $\eta^{j}_{i}$ - базисные квадратичные полиномы Лагранжа, которые могут быть записаны в виде:

$$
\begin{gather}
   \eta^{j}_{2}(t) = \frac{(t - t_{j-1})(t-t_{j})}{{\Delta t_{1}\Delta t}} \tag{7.15} \\[5px]
   \eta^{j}_{1}(t) = - \frac{(t - t_{j-2})(t-t_{j})}{\Delta t_{1}\Delta t_{0}} \tag{7.16} \\[5px]
   \eta^{j}_{0}(t) = \frac{(t - t_{j-2})(t-t_{j-1})}{{\Delta t\Delta t_0}} \tag{7.17} 
\end{gather}
$$

где:

$$
\Delta t = t_{j}-t_{j-2}, \ \Delta t_{1}= t_{j-1}-t_{j-2}, \ \Delta t_{0}= t_{j}- t_{j-1} \tag{7.18}
$$

Чтобы получить явную схему аппроксимации уравнения $(7.2)$ с неравномерным шагом по времени, вычислим значения первой и второй производных функций $(7.15)-(7.17)$ при $t=t_{j-1}$:

$$\Large
\begin{matrix}
   \left. \frac{d\eta^{j}_{2} (t)}{dt} \right|_{t=t_{j-1}} = -\frac{\Delta t_{0}}{\Delta t \Delta t_{1}}; & 
   \left. \frac{d^{2}\eta^{j}_{2} (t)}{dt^{2}} \right|_{t=t_{j-1}} = \frac{2}{{\Delta t \Delta t_{1}}}; \\
   \left. \frac{d\eta^{j}_{1} (t)}{dt} \right|_{t=t_{j-1}} = \frac{\Delta t_{0} - \Delta t_{1}}{\Delta t_{1} \Delta t_{0}}; & 
   \left. \frac{d^{2}\eta^{j}_{1} (t)}{dt^{2}} \right|_{t=t_{j-1}} = -\frac{2}{{\Delta t_{1} \Delta t_{0}}}; \\
   \left. \frac{d\eta^{j}_{0} (t)}{dt} \right|_{t=t_{j-1}} = \frac{\Delta t_{1}}{\Delta t \Delta t_{0}}; & 
   \left. \frac{d^{2}\eta^{j}_{0} (t)}{dt^{2}} \right|_{t=t_{j-1}} = \frac{2}{{\Delta t \Delta t_{0}}}.
\end{matrix}
$$

С учётом уравнения $(7.14)$ первая и вторая производные по времени аппроксимируются так:

$$
\begin{align*}
  \left. \frac{\partial u}{\partial t} \right|_{t=t_{j-1}} &\approx -\frac{\Delta t_{0}}{\Delta t \Delta t_{1}} \ u^{j-2} + \frac{\Delta t_{0} - \Delta t_{1}}{\Delta t_{1} \Delta t_{0}} \ u^{j-1} + \frac{\Delta t_{1}}{\Delta t \Delta t_{0}} \ u^{j}, \\
  \left. \frac{\partial^{2} u}{\partial t^{2}} \right|_{t=t_{j-1}} &\approx \frac{2}{{\Delta t \Delta t_{1}}} \ u^{j-2} - \frac{2}{{\Delta t_{1} \Delta t_{0}}} \ u^{j-1} + \frac{2}{{\Delta t \Delta t_{0}}} \ u^j,
\end{align*}
$$

и тогда аппроксимация дифференциального уравнения $(7.2)$ по времени может быть записана в виде:

$$
\begin{split}
   \chi \left( \frac{2}{{\Delta t \Delta t_{1}}} \ u^{j-2} - \frac{2}{{\Delta t_{1} \Delta t_{0}}} \ u^{j-1} + \frac{2}{{\Delta t \Delta t_{0}}} \ u^{j} \right) +\\
   +\sigma \left( -\frac{\Delta t_{0}}{\Delta t \Delta t_{1}} \ u^{j-2} + \frac{\Delta t_{0} - \Delta t_{1}}{\Delta t_{1} \Delta t_{0}} \ u^{j-1} + \frac{\Delta t_{1}}{\Delta t \Delta t_{0}} \ u^{j} \right) - \\ 
   -{  div}(\lambda \ {  grad}(u^{j-1})) = f^{j-1} \tag{7.42}
\end{split} 
$$

Конечномерная аппроксимация краевой задачи для уравнения $(7.42)$ приведёт к матричному уравнению вида

$$
\begin{split}
   \frac{2}{{\Delta t \Delta t_{1}}} M^{\chi} q^{j-2} - \frac{2}{{\Delta t_{1} \Delta t_{0}}} M^{\chi} q^{j-1} + \frac{2}{{\Delta t \Delta t_{0}}} M^{\chi} q^{j} - \\
   -\frac{\Delta t_{0}}{\Delta t \Delta t_{1}} M^{\sigma} q^{j-2} + \frac{\Delta t_{0} - \Delta t_{1}}{\Delta t_{1} \Delta t_{0}} M^{\sigma} q^{j-1} + \frac{\Delta t_{1}}{\Delta t \Delta t_{0}} M^{\sigma} q^{j} + Gq^{j-1} = b^{j-1} \tag{7.43}
\end{split}
$$

которое фактически является СЛАУ для вектора $q^j$ с матрицей $A$ и вектором правой части $d$ следующего вида:

$$
A = \frac{2}{{\Delta t \Delta t_{0}}} M^{\chi} + \frac{\Delta t_{1}}{\Delta t \Delta t_{0}} M^{\sigma},
$$

$$
d = b^{j-1} - \frac{2}{{\Delta t \Delta t_{1}}} M^{\chi} q^{j-2} + \frac{2}{{\Delta t_{1} \Delta t_{0}}} M^{\chi} q^{j-1} + \frac{\Delta t_{0}}{\Delta t \Delta t_{1}} M^{\sigma} q^{j-2} - \frac{\Delta t_{0} - \Delta t_{1}}{\Delta t_{1} \Delta t_{0}} M^{\sigma} q^{j-1} - G q^{j-1}.
$$

В целом, на этом всё.

## Тестирование

Для создания тестов будем опираться на следующее уравнение:

$$
-\frac{1}{r}\frac{\partial}{\partial r}\left(r\lambda \frac{\partial u}{\partial r}\right) - \frac{1}{r^{2}}\frac{\partial}{\partial \varphi}\left(\lambda \frac{\partial u}{\partial \varphi}\right) + \sigma \frac{\partial u}{\partial t} + \chi \frac{\partial^{2}u}{\partial t^{2}} = f
$$

Сетка 3х3, шаг 3, краевые на всех узлах, кроме центрального.

### Тестирование на работоспособность

#### Тест 1. $u=t$

$u=t$, $\lambda=1$, $\sigma = 1$, $\chi = 1$, $f = \sigma = 1$

| время |  норма погрешности   |
|  ---  |  ---                 |
|     0 | 0.00000000000000e+00 |
|     1 | 0.00000000000000e+00 |
|     2 | 1.25607396694702e-15 |
|     3 | 1.33226762955019e-15 |
|     4 | 2.66453525910038e-15 |
|     5 | 3.55271367880050e-15 |
|     6 | 6.21724893790088e-15 |
|     7 | 6.21724893790088e-15 |
|     8 | 4.44089209850063e-15 |
|     9 | 7.10542735760100e-15 |
|    10 | 1.24344978758018e-14 |

#### Тест 2. $u = t + r$

$u = t+r$, $\lambda = r$, $\sigma = 1$, $\chi = 1$, $f = -1$

| время |  норма погрешности   |
|  ---  |  ---                 |
|     0 | 0.00000000000000e+00 |
|     1 | 0.00000000000000e+00 |
|     2 | 3.41111394591414e-15 |
|     3 | 4.44089209850063e-15 |
|     4 | 2.66453525910038e-15 |
|     5 | 0.00000000000000e+00 |
|     6 | 1.77635683940025e-15 |
|     7 | 1.77635683940025e-15 |
|     8 | 3.55271367880050e-15 |
|     9 | 3.55271367880050e-15 |
|    10 | 1.77635683940025e-15 |

### Тестирование на порядок аппроксимации

#### Тест 3. $u=t^2$

$u=t^2$, $\lambda = 1$, $\sigma = 1$, $\chi = 1$, $f = 2t + 2$

| время |  норма погрешности   |
|  ---  |  ---                 |
|     0 | 0.00000000000000e+00 |
|     1 | 0.00000000000000e+00 |
|     2 | 2.51214793389404e-15 |
|     3 | 0.00000000000000e+00 |
|     4 | 3.55271367880050e-15 |
|     5 | 3.55271367880050e-15 |
|     6 | 0.00000000000000e+00 |
|     7 | 1.42108547152020e-14 |
|     8 | 1.42108547152020e-14 |
|     9 | 1.42108547152020e-14 |
|    10 | 1.42108547152020e-14 |

#### Тест 4. $u = t^3$

$u=t^3$, $\lambda = 1$, $\sigma = 1$, $\chi = 1$, $f = 3t^2 + 6t$

| время |  норма погрешности   |
|  ---  |  ---                 |
|     0 | 0.00000000000000e+00 |
|     1 | 0.00000000000000e+00 |
|     2 | 1.50000000000000e+00 |
|     3 | 3.14441127380945e+00 |
|     4 | 4.44713689876385e+00 |
|     5 | 5.32714427706435e+00 |
|     6 | 5.85763177135487e+00 |
|     7 | 6.14585572273876e+00 |
|     8 | 6.28499903466718e+00 |
|     9 | 6.34146360474597e+00 |
|    10 | 6.35698315117543e+00 |

### Тестирование на порядок сходимости (тест 5)

Формула для подсчёта порядка сходимости:

$$
\frac{\lVert u^{*} - u^{h} \rVert}{\lVert u^{*}- u^{\frac{h}{2}} \rVert} \approx 2^k
$$

$u=e^t$, $\lambda=1$, $\sigma = 1$, $\chi=1$, $f= 2*e^t$

Результаты при $t = 4$:

| Шаг   | Норма погрешности    | порядок сходимости |
| ----- | -------------------- | ------------------ |
| 1     | 1.19756615034468e+01 |                    |
| 0.5   | 3.15578759035698e+00 | 3.79482            |
| 0.25  | 8.00329512433713e-01 | 3.94311            |
| 0.125 | 2.00909784092126e-01 | 3.98352            | 

